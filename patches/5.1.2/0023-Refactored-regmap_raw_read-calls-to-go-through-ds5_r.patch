From d8b399c6f94aa4f1ca5bd0d073b531da9d4442a8 Mon Sep 17 00:00:00 2001
From: Alexander Hoffman <alxhoff@gmail.com>
Date: Thu, 4 Dec 2025 13:11:10 +0100
Subject: [PATCH 23/26] Refactored regmap_raw_read calls to go through
 ds5_raw_read

---
 kernel/nvidia/drivers/media/i2c/d4xx.c | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

diff --git a/kernel/nvidia/drivers/media/i2c/d4xx.c b/kernel/nvidia/drivers/media/i2c/d4xx.c
index 897db8086..ee6907827 100644
--- a/kernel/nvidia/drivers/media/i2c/d4xx.c
+++ b/kernel/nvidia/drivers/media/i2c/d4xx.c
@@ -1837,7 +1837,7 @@ static int ds5_get_hwmc(struct ds5 *state, unsigned char *data,
 		}
 	}
 
-	ret = regmap_raw_read(state->regmap, DS5_HWMC_RESP_LEN,
+	ret = ds5_raw_read(state, DS5_HWMC_RESP_LEN,
 			&tmp_len, sizeof(tmp_len));
 	if (ret)
 		return -EBADMSG;
@@ -2272,7 +2272,7 @@ static int ds5_get_calibration_data(struct ds5 *state, enum table_id id,
 	}
 
 	// get table length from fw
-	ret = regmap_raw_read(state->regmap, 0x4908,
+	ret = ds5_raw_read(state, DS5_HWMC_RESP_LEN,
 			&table_length, sizeof(table_length));
 
 	// read table
@@ -2458,7 +2458,7 @@ static int ds5_g_volatile_ctrl(struct v4l2_ctrl *ctrl)
 //		if (i == DS5_MAX_LOG_POLL)
 //			return -ETIMEDOUT;
 
-		ret = regmap_raw_read(state->regmap, 0x4908, &data, sizeof(data));
+		ret = ds5_raw_read(state, DS5_HWMC_RESP_LEN, &data, sizeof(data));
 		dev_dbg(&state->client->dev, "%s(): log size 0x%x\n", __func__, data);
 		if (ret < 0)
 			break;
@@ -2470,7 +2470,7 @@ static int ds5_g_volatile_ctrl(struct v4l2_ctrl *ctrl)
 			ret = -ENOBUFS;
 			break;
 		}
-		ret = regmap_raw_read(state->regmap, 0x4900, ctrl->p_new.p_u8, data);
+		ret = ds5_raw_read(state, DS5_HWMC_DATA, ctrl->p_new.p_u8, data);
 		break;
 	case DS5_CAMERA_DEPTH_CALIBRATION_TABLE_GET:
 		ret = ds5_get_calibration_data(state, DEPTH_CALIBRATION_ID,
-- 
2.51.0

